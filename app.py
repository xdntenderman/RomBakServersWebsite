from flask import Flask, request, jsonify\nfrom flask_sqlalchemy import SQLAlchemy\nfrom flask_bcrypt import Bcrypt\nfrom flask_jwt_extended import JWTManager, create_access_token, jwt_required, get_jwt_identity\n\napp = Flask(__name__)\napp.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///users.db'\napp.config['JWT_SECRET_KEY'] = 'your_jwt_secret_key' # Change this!\n\ndb = SQLAlchemy(app)\nbcrypt = Bcrypt(app)\njwt = JWTManager(app)\n\nclass User(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    username = db.Column(db.String(80), unique=True, nullable=False)\n    password = db.Column(db.String(128), nullable=False)\n\n    def __repr__(self):\n        return f'<User {self.username}>'\n\n@app.before_first_request\ndef create_tables():\n    db.create_all()\n\n@app.route('/register', methods=['POST'])\ndef register():\n    username = request.json['username']\n    password = request.json['password']\n    hashed_password = bcrypt.generate_password_hash(password).decode('utf-8')\n    new_user = User(username=username, password=hashed_password)\n    db.session.add(new_user)\n    db.session.commit()\n    return jsonify({'message': 'User registered successfully'}), 201\n\n@app.route('/login', methods=['POST'])\ndef login():\n    username = request.json['username']\n    password = request.json['password']\n    user = User.query.filter_by(username=username).first()\n    if user and bcrypt.check_password_hash(user.password, password):\n        access_token = create_access_token(identity=user.id)\n        return jsonify(access_token=access_token), 200\n    return jsonify({'message': 'Invalid credentials'}), 401\n\n@app.route('/protected', methods=['GET'])\n@jwt_required()\ndef protected():\n    current_user = get_jwt_identity()\n    return jsonify({'message': f'Hello, {current_user}'}), 200\n\nif __name__ == '__main__':\n    app.run(debug=True)